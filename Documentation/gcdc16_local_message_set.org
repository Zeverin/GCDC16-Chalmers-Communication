#+author: Albin Severinson
#+title: GCDC16 Local Message Set

| Version: | 0.1 | First draft                |
|          | 0.2 | Revised CAM and added DENM |
|          |     |                            |

\newpage
* Introduction
This document presents the local message set (LMS) to be used for
GCDC16. LMS will be used by the sensor fusion system to generate CAM
messages, and by the scenario control models to generate DENM/iGAME
messages.

The communication stack includes a vehicle adapter that will receive
these messages and use them to create proper CAM/DENM/iGAME messages
that will be forwarded to other vehicles. The LMS follows the ETSI
specification as closely as possible, but makes some changes to make
is possible to create the messages in Simulink.

Different network ports will be used for CAM/DENM/iGAME messages in
order to distinguish them.

All data is in network byte order, which is identical to big endian.

* CAM
CAM consists of a single large message that is sent to the
communication stack periodically. The communication stack will pick up
the message and make a decision on what parts of the message to forward
to other vehicles. The message should contain the specified data, in
the specified order. Data marked as N/A should be all zeroes.

|--------+--------------------------------------------------+-----------------------------|
| Bytes: | Data:                                            | Notes                       |
|--------+--------------------------------------------------+-----------------------------|
|      1 | header                                           | More details?               |
|      4 | GenerationDeltaTime                              | See D3.2                    |
|      0 | Station ID                                       | Handled by communication SW |
|      1 | Station Type                                     | See D3.2                    |
|      1 | Vehicle Role                                     | See D3.2                    |
|      2 | Vehicle Length                                   | See D3.2                    |
|      2 | Vehicle Width                                    | See D3.2                    |
|      0 | Reference position                               | See D3.2                    |
|      4 | Latitude                                         | See D3.2                    |
|      4 | Longitude                                        | See D3.2                    |
|      ? | Position Confidence Ellipse 95%                  | Need more details           |
|      ? | Altitude                                         | Not in D3.2?                |
|      2 | Heading                                          | See D3.2                    |
|      1 | Heading confidence 95%                           | See D3.2                    |
|      2 | Speed                                            | See D3.2                    |
|      1 | Speed Confidence 95%                             | See D3.2                    |
|      2 | Yaw Rate                                         | See D3.2                    |
|      1 | Yaw Rate Confidence 95%                          | See D3.2                    |
|      2 | Longitudinal vehicle acceleration                | See D3.2                    |
|      1 | Longitudinal vehicle acceleration confidence 95% | See D3.2                    |
|        |                                                  |                             |



* DENM
DENM messages are sent on-demand. D3.2 describes four different DENM
messages, but due to how DENM messages are structured with several
data containers in every message, it turns out that there are only two
distinct messages used for GCDC16.

The roadworks message is used to notify the vehicles in scenario one that
there are roadworks ahead, and what lane is blocked because of that.
The emergency vehicle message is used to notify the vehicles in scenario three
that there's an emergency vehicle approaching, and what lane it is
requesting.

The LMS for DENM messages follows the specification very loosely as
it's not worth the time to implement the full standard when only two
distinct messages are used. 

The fields marked "dummy field" are presented in the spec but doesn't
contain any data, and as such are 0 bytes long.

|-------------------+---------------------+--------+-------------|
| DENM Message:     | Data:               | Bytes: | Notes::     |
|-------------------+---------------------+--------+-------------|
| Roadworks         | Message ID          |      1 | $=38$       |
|                   | Reference Time      |      8 | See D3.2    |
|                   | Event Type          |      0 | Dummy field |
|                   | Cause Code          |      1 | See D3.2    |
|                   | Sub Cause Code      |      1 | See D3.2    |
|                   | Closed Lanes        |      0 | See D3.2    |
|                   | Driving Lane Status |      1 | See D3.2    |
|-------------------+---------------------+--------+-------------|
| Emergency Vehicle | Message ID          |      1 | $=40$       |
|                   | Reference Time      |      8 | See D3.2    |
|                   | Event Type          |      0 | Dummy field |
|                   | Cause Code          |      1 | See D3.2    |
|                   | Sub Cause Code      |      1 | See D3.2    |
|                   | Lane Position       |      1 | See D3.2    |
|                   |                     |        |             |



* iGAME
The iGAME message set is still under proposal. Details on this set
will be presented in a future release of this document. As it looks
now the structure is very similar to DENM, but the details on how
these are to be transmitted are still unclear.



